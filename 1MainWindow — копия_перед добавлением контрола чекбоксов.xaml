<Window x:Class="WpfApp04.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:WpfApp04.Controls"
        mc:Ignorable="d"
        WindowStartupLocation="Manual" Left="0" Top= "0"
        WindowState="Maximized"
        
        Title="MainWindow"  Width="1920" Height="900" Closing="Window_Closing" >

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="1*"/>

        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="1.8*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="2*"/>

        </Grid.RowDefinitions>

        <ToolBar Grid.Row="0" Grid.ColumnSpan="3" Margin="0,0,0,0" Grid.RowSpan="1">
            <Menu>
                <MenuItem Header="Файл">

                    <MenuItem Header="Открыть" Click="OpenFile_Click" />
                    <MenuItem Header="Открыть для импорта" Name="OpenForImport_menuItem" Click="OpenForImport_menuItem_Click" />
                    <MenuItem Header="Закрыть" Click="CloseFile_Click" />
                    <MenuItem x:Name="ElectonicMap_menuItem" Header="Открыть ElectonicMap" Click="ElectonicMap_menuItem_Click" />


                </MenuItem>
                <MenuItem Header="Инструменты">
                    <MenuItem Name="EmapShowMenuItem" Header="показать Екарту" Click="EmapShowMenuItem_Click"/>
                    <MenuItem Header="Проверить" Click="Test_Click"/>
                    <MenuItem Header="ЕГИСТПС">
                        <MenuItem Name="EgisConnectMenuItem" Header="Connect" Click="EgisConnectMenuItem_Click" />
                        <MenuItem Name="EgisDisconnectMenuItem" Header="Disconnect" Click="EgisDisconnectMenuItem_Click" />
                    </MenuItem>
                    <MenuItem Header="Экспорт Скорости" Click ="ExportSpeedsClick" />
                    <StackPanel Orientation="Horizontal" >
                        <TextBlock Text="масштаб " />
                        <TextBox x:Name="ScaletextBox" Width="Auto" Text="100"  KeyDown="ScaletextBox_KeyDown" Background="{x:Null}" />
                        <TextBlock Text="%" />

                    </StackPanel>
                    <MenuItem Header="Incline Control" Click="ShowInclineItemCLick" />
                    <MenuItem x:Name="DeleteNopointSign" Header="Удалить знаки С без точек на пути" Click="DeleteNopointSign_Click"/>
                    <MenuItem x:Name="DeleteNopointSign2" Header="Удалить не проставленные знаки С" Click="DeleteNopointSign2_Click"/>
                    <MenuItem x:Name="DeleteAllInclines" Header="Удалить все уклоны" Click="DeleteAllInclines_Click"/>
                    <MenuItem x:Name="FrogModelMenuItem" Header="Марка крестовины 11" Click="FrogModelMenuItem_Click"/>
                    <MenuItem Header="Установить частоту АЛС">
                        <MenuItem Name="AutoBlockFrequency1" Header="25 ГЦ - 1" Click="AutoBlockFrequency1_Click" />
                        <MenuItem Name="AutoBlockFrequency2" Header="50 ГЦ - 2" Click="AutoBlockFrequency2_Click" />
                    </MenuItem>

                </MenuItem>

            </Menu>


        </ToolBar>


        <GridSplitter x:Name="HorisontalSplitter" Grid.Column="0"  Grid.Row="2" Grid.ColumnSpan="3" ShowsPreview="False" Height="6"
        HorizontalAlignment="Stretch" VerticalAlignment="Center" />

        <ScrollViewer Grid.Row="3" HorizontalScrollBarVisibility="Visible" VerticalScrollBarVisibility="Visible" Grid.ColumnSpan="3" Grid.RowSpan="1"  >

            <local:DrawingCanvas x:Name="wrapPanel" Focusable="true" Background="Transparent" 
                      Height="560"
                      MouseRightButtonDown="wrapPanel_MouseRightButtonDown" 
                      MouseLeftButtonDown="wrapPanel_MouseLeftButtonDown" 
                      MouseWheel="ScrollViewer_MouseWheel" VerticalAlignment="Bottom" >

            </local:DrawingCanvas>
        </ScrollViewer>

        <TabControl Grid.Column="0" Grid.Row="1" Grid.RowSpan="1">

            <TabItem Header="ЕГИС">

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="500"/>
                        <ColumnDefinition Width="10"/>
                        <ColumnDefinition/>

                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="1*"/>

                    </Grid.RowDefinitions>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="1*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="30"/>
                            <RowDefinition Height="80"/>
                            <RowDefinition Height="5"/>
                            <RowDefinition/>

                        </Grid.RowDefinitions>
                        <TextBox x:Name="StaitonToFindTextBox" HorizontalAlignment="Left" Margin="93,0,0,0" TextWrapping="Wrap" Text="" VerticalAlignment="Center" Width="139" Height="18" KeyDown="StaitonToFindTextBox_KeyDown"/>
                        <TextBlock HorizontalAlignment="Left" Margin="4,0,0,0" TextWrapping="Wrap" Text="Поиск Станции" VerticalAlignment="Center" Height="16" Width="84"/>
                        <Button x:Name="EgisFindStationButton" Content="Найти" HorizontalAlignment="Left" Margin="237,0,0,0" VerticalAlignment="Center" Width="58" Click="EgisFindStationButton_Click" Height="20"/>
                        <Button x:Name="EgisLoadDataButton" Content="Загрузить" HorizontalAlignment="Left" Margin="300,0,0,0" VerticalAlignment="Center" Width="58" Height="20" Click="EgisLoadDataButton_Click"/>

                        <DataGrid x:Name="EgisStationsGrid"  
                                  IsReadOnly="True"
                              AutoGenerateColumns="False" 
                              Background="#FFF0F0F0" 
                              HorizontalGridLinesBrush="Gray" 
                              Grid.Row="1"
                              Grid.RowSpan="1"
                              VerticalGridLinesBrush="Gray" 
                              ColumnHeaderHeight="25" 
                              CanUserResizeRows="False" 
                              CanUserAddRows="False" 
                              CanUserDeleteRows="False" MouseDoubleClick="EgisStationsGrid_MouseDoubleClick"   >
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="StationID" Binding="{Binding Path=EgisStationID}" Width="80"/>
                                <DataGridTextColumn Header="Станция" Binding="{Binding Path=StationName}" Width="1*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                        <GridSplitter  Grid.Column="0"  Grid.Row="2" Grid.ColumnSpan="1" ShowsPreview="False" Height="Auto"
        HorizontalAlignment="Stretch" />
                        <DataGrid x:Name="EgisTrackGrid"  
                                  IsReadOnly="True"
                              AutoGenerateColumns="False" 
                              Background="#FFF0F0F0" 
                              HorizontalGridLinesBrush="Gray" 
                              Grid.Row="3"
                              Grid.RowSpan="1"
                              VerticalGridLinesBrush="Gray" 
                              ColumnHeaderHeight="25" 
                              CanUserResizeRows="False" 
                              CanUserAddRows="False" 
                              CanUserDeleteRows="False" 
                              Margin="0,115,0,0" MouseDoubleClick="EgisTrackGrid_MouseDoubleClick" SelectionChanged="EgisTrackGrid_SelectionChanged"  >
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="TrackID" Binding="{Binding Path=TrackID}" Width="80"/>
                                <DataGridTextColumn Header="Путь" Binding="{Binding Path=TrackNumber}" Width="1*"/>
                            </DataGrid.Columns>
                        </DataGrid>

                        <RadioButton x:Name="MaintrackRadioButton" GroupName="TrackKind" Content="главные пути" HorizontalAlignment="Left" Margin="10,5,0,0" Grid.Row="3" VerticalAlignment="Top" Checked="MaintrackRadioButton_Checked"/>
                        <RadioButton x:Name="SideTrackRadioButton"  GroupName="TrackKind" Content="станционные пути" HorizontalAlignment="Left" Margin="107,5,0,0" Grid.Row="3" VerticalAlignment="Top" Checked="SideTrackRadioButton_Checked" />
                        <RadioButton x:Name="UpUsageDirectionToFindRadioButton" GroupName="UsageDirection" Content="по возрастанию" HorizontalAlignment="Left" Margin="278,5,0,0" Grid.Row="3" VerticalAlignment="Top" Checked="UpUsageDirectionToFindRadioButton_Checked"/>
                        <RadioButton x:Name="DownUsageDirectionToFindRadioButton"  GroupName="UsageDirection" Content="по убыванию" HorizontalAlignment="Left" Margin="396,5,0,0" Grid.Row="3" VerticalAlignment="Top" Checked="DownUsageDirectionToFindRadioButton_Checked" />
                        <GroupBox Header="Ограничения скоростей и ПТ" Grid.Row="3" Margin="6,20,0,0" Grid.RowSpan="2" HorizontalAlignment="Left" VerticalAlignment="Top" >
                            <Grid Height="67">
                                <RadioButton x:Name="FreightSpeedRadioButton_Copy" GroupName="SpeedKind" Content="груз" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="4,4,0,0" Height="16" Width="50" Checked="FreightSpeedRadioButton_Checked"/>
                                <RadioButton x:Name="PassSpeedRadioButton_Copy1" GroupName="SpeedKind" Content="пасс" Height="16" Width="50" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="4,20,0,0" Checked="PassSpeedRadioButton_Copy1_Checked"/>
                                <RadioButton x:Name="HighSpeedRadioButton" GroupName="SpeedKind" Content="скоростное" Height="16" Width="89" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="4,51,0,0" Checked="HighSpeedRadioButton_Checked"/>
                                <RadioButton x:Name="VeryHighSpeedRadioButton" GroupName="SpeedKind" Content="высокоскоростное" Height="16" Width="122" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="4,36,0,0" Checked="VeryHighSpeedRadioButton_Checked"/>
                                <RadioButton x:Name="EtrainSpeedRadioButton" GroupName="SpeedKind" Content="электропоезда" Height="16" Width="104" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="143,4,0,0" Checked="EtrainSpeedRadioButton_Checked" />
                                <RadioButton x:Name="MvpsSpeedRadioButton" GroupName="SpeedKind" Content="МВПС" Height="16" Width="97" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="143,20,0,0" Checked="MvpsSpeedRadioButton_Checked" />
                                <RadioButton x:Name="PrigSpeedRadioButton" GroupName="SpeedKind" Content="Пригородное" Height="16" Width="97" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="143,36,0,0" Checked="PrigSpeedRadioButton_Checked" />


                            </Grid>

                        </GroupBox>
                        <GroupBox Header="данные для таблиц" Grid.Row="3" Margin="272,20,0,0" HorizontalAlignment="Left" VerticalAlignment="Top" Height="90" >
                            <Grid Height="52">
                                <RadioButton x:Name="StationDataGridSourceRadioButtonEgis" GroupName="StationDataGridSourceGroup" Content="Егис" HorizontalAlignment="Left" VerticalAlignment="Top" Width="85" Checked="StationDataGridSourceRadioButtonEgis_Checked"/>
                                <RadioButton x:Name="StationDataGridSourceRadioButtonDb" GroupName="StationDataGridSourceGroup" Content="База mdb*" HorizontalAlignment="Left" Margin="0,15,0,0" VerticalAlignment="Top" Width="85" Checked="StationDataGridSourceRadioButtonDb_Checked"/>
                                <RadioButton x:Name="StationDataGridSourceRadioButtonToAdd" IsEnabled="True" Visibility="Hidden"
                                    GroupName="StationDataGridSourceGroup" Content="Импорт" HorizontalAlignment="Left" Margin="0,30,0,0" VerticalAlignment="Top" Width="85" Checked="StationDataGridSourceRadioButtonToAdd_Checked" />


                            </Grid>

                        </GroupBox>

                    </Grid>

                    <GridSplitter Grid.Column="1"  Grid.Row="0" ShowsPreview="False" Width="6"
                                HorizontalAlignment="Center" />
                    <Button x:Name="ShowEgisPreviewButton" Grid.Column="0" Content="Показать" HorizontalAlignment="Left" Margin="363,5,0,0" VerticalAlignment="Top" Click="ShowEgisPreviewButton_Click" Width="58"/>

                    <TabControl Grid.Column="2">
                        <TabItem Header="Импорт">
                            <Grid Background="#FFE5E5E5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="1*"/>
                                    <ColumnDefinition Width="10"/>
                                    <ColumnDefinition Width="1*"/>

                                </Grid.ColumnDefinitions>
                                <DataGrid 
                                    x:Name="SegmentsToFillFromEgisGrid" 
                                    AutoGenerateColumns="False"
                                    CanUserAddRows="False" CanUserDeleteRows="False" >

                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="ID" Binding="{Binding Path=SegmentID}" Width="60"/>
                                        <DataGridTextColumn Header="Имя сегмента" Binding="{Binding Path=SegmentName}" Width="1*"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <GridSplitter Grid.Column="1"  Grid.Row="0" Grid.ColumnSpan="1" ShowsPreview="False" Width="5" HorizontalAlignment="Center" VerticalAlignment="Stretch" />
                                <Button Name="AddSegmentsToFillFromEgisButton" Grid.Column="2" Content="Выбрать" HorizontalAlignment="Left" Margin="4,4,0,0" VerticalAlignment="Top" Click="AddSegmentsToFillFromEgisButton_Click" Width="63"/>
                                <TextBlock Name="SegmentsToFillFromEgisTextBlock" Background="LightGray" Grid.Column="2" HorizontalAlignment="Left" Margin="90,40,0,0" TextWrapping="Wrap" Text="ResultSegmentID" VerticalAlignment="Top" Height="20" Width="148"/>
                                <Button Name="FillFromEgisButton" Grid.Column="2" Content="Загрузить" HorizontalAlignment="Left" Margin="4,67,0,0" VerticalAlignment="Top" Width="63" Click="FillFromEgisButton_Click"/>
                                <Button x:Name="InsertFromEgisToBaseButton" Grid.Column="2" Content="Внести в базу" HorizontalAlignment="Left" Margin="4,95,0,0" VerticalAlignment="Top" Width="85" Click="InsertFromEgisToBaseButton_Click"/>
                                <CheckBox x:Name="DeleteTrackCircuitsChickBox" Grid.Column="2" Content="Удалить РЦ" HorizontalAlignment="Left" Margin="94,98,0,0" VerticalAlignment="Top"/>
                                <CheckBox x:Name="KmShortenCheckBox" Grid.Column="2" Content="поправка длины КМ" HorizontalAlignment="Left" Margin="94,69,0,0" VerticalAlignment="Top"/>
                                <Button x:Name="ClearToAddListsButtony" Grid.Column="2" Content="Очистить" HorizontalAlignment="Left" Margin="269,40,0,0" VerticalAlignment="Top" Width="63" Click="ClearToAddListsButtony_Click"/>

                                <CheckBox x:Name="ImportTrafficLightsCheckBox" Grid.Column="2" Content="Светофоры" HorizontalAlignment="Left" Margin="4,120,0,0" VerticalAlignment="Top"/>
                                <CheckBox x:Name="ImportPlatformsCheckBox" Grid.Column="2" Content="Платформы" HorizontalAlignment="Left" Margin="4,140,0,0" VerticalAlignment="Top"/>
                                <CheckBox x:Name="ImportUkspsCheckBox" Grid.Column="2" Content="Укспс" HorizontalAlignment="Left" Margin="4,161,0,0" VerticalAlignment="Top"/>
                                <CheckBox x:Name="ImportKtsmCheckBox" Grid.Column="2" Content="КТСМ" HorizontalAlignment="Left" Margin="4,181,0,0" VerticalAlignment="Top"/>
                                <CheckBox x:Name="ImportSignsCheckBox" Grid.Column="2" Content="Сигнальный знак" HorizontalAlignment="Left" Margin="4,200,0,0" VerticalAlignment="Top"/>
                                <CheckBox x:Name="ImportCrossingsCheckBox" Grid.Column="2" Content="переезд" HorizontalAlignment="Left" Margin="4,220,0,0" VerticalAlignment="Top"/>
                                <CheckBox x:Name="ImportNeutralSectionsCheckBox" Grid.Column="2" Content="нейтральная вставка" HorizontalAlignment="Left" Margin="4,240,0,0" VerticalAlignment="Top"/>
                                <CheckBox x:Name="ImportInclinesCheckBox" Grid.Column="2" Content="Уклоны" HorizontalAlignment="Left" Margin="164,120,0,0" VerticalAlignment="Top"/>
                                <CheckBox x:Name="ImportSpeedCheckBox" Grid.Column="2" Content="Ограничения скорости" HorizontalAlignment="Left" Margin="164,140,0,0" VerticalAlignment="Top"/>
                                <CheckBox x:Name="ImportStationBordersCheckBox" Grid.Column="2" Content="Границы станций" HorizontalAlignment="Left" Margin="164,161,0,0" VerticalAlignment="Top"/>

                                <TextBlock x:Name="SegmentsSourceFromEgisTextBlock" Background="LightGray" Grid.Column="2" HorizontalAlignment="Left" Margin="90,4,0,0" TextWrapping="Wrap" Text="SourceSegmentID" VerticalAlignment="Top" Height="20" Width="148"/>


                            </Grid>
                        </TabItem>
                        <TabItem Header="Поиск объекта">
                            <Grid Grid.Column="2">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="30"/>
                                    <RowDefinition Height="140"/>
                                    <RowDefinition Height="5"/>
                                    <RowDefinition Height="1*"/>
                                </Grid.RowDefinitions>
                                <TextBlock HorizontalAlignment="Left" Margin="10,0,0,0" TextWrapping="Wrap" Text="Поиск объекта" VerticalAlignment="Center"/>
                                <TextBox Name="PointObjectToFindTextBox" HorizontalAlignment="Left" Margin="97,0,0,0" TextWrapping="Wrap" Text="" VerticalAlignment="Center" Width="57"/>
                                <DataGrid Grid.Row="3" 
                                          IsReadOnly="True"
                                          x:Name="EgisFoundPointObjectsGrid" 
                                          AutoGenerateColumns="False" 
                                          MouseDoubleClick="EgisFoundPointObjectsGrid_MouseDoubleClick">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="TrackObjectName" Binding="{Binding Path=TrackObjectName}" Width="2*"/>
                                        <DataGridTextColumn Header="Км" Binding="{Binding Path=PointOnTrackKm}" Width="45"/>
                                        <DataGridTextColumn Header="Пк" Binding="{Binding Path=PointOnTrackPk}" Width="35"/>
                                        <DataGridTextColumn Header="М" Binding="{Binding Path=PointOnTrackM}" Width="45"/>
                                        <DataGridTextColumn Header="Путь" Binding="{Binding Path=TrackNumber}" Width="1*"/>

                                    </DataGrid.Columns>
                                </DataGrid>
                                <Button x:Name="EgisFindPointObjectsButton" Content="Найти" HorizontalAlignment="Left" Margin="159,0,0,0" VerticalAlignment="Center" Width="60" Click="EgisFindPointObjectsButton_Click"/>
                            </Grid>

                        </TabItem>


                        <TabItem Header="PointOntrack">
                            <Grid Grid.Column="0">

                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="464*"/>
                                    <ColumnDefinition Width="5"/>
                                    <ColumnDefinition Width="247*"/>
                                    <ColumnDefinition Width="682*"/>

                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="30"/>
                                    <RowDefinition Height="1*"/>
                                </Grid.RowDefinitions>

                                <DataGrid Grid.Row="1" 
                                          IsReadOnly="True"
                                          x:Name="PointOnTrackEditGrid" 
                                          AutoGenerateColumns="False" SelectionChanged="PointOnTrackEditGrid_SelectionChanged">
                                    <DataGrid.Columns>

                                        <DataGridTextColumn Header="Тип точки на пути" Binding="{Binding Path=DicPointOnTrackKindName}" Width="180"/>

                                        <DataGridTextColumn Header="Км" Binding="{Binding Path=PointOnTrackKm}" Width="45"/>
                                        <DataGridTextColumn Header="Пк" Binding="{Binding Path=PointOnTrackPk}" Width="35"/>
                                        <DataGridTextColumn Header="М" Binding="{Binding Path=PointOnTrackM}" Width="45"/>
                                        <DataGridTextColumn Header="Координата по маршруту" Binding="{Binding Path=RouteCoordinate}" Width="1*"/>

                                    </DataGrid.Columns>
                                </DataGrid>
                                <GridSplitter Grid.Column="1"  Grid.Row="0" Grid.RowSpan="2" ShowsPreview="False" Width="5"
                                              HorizontalAlignment="Center" />
                                <CheckBox Grid.Column="2" Content="Точка смены рода тока"  HorizontalAlignment="Left" Margin="10,10,0,0" Grid.Row="1" VerticalAlignment="Top" Width="160" Height="15"/>

                                <local:PointOnTrackMenuControl 
                                    x:Name="pointOnTrackMenuControl1"
                                    Grid.Column="3" Grid.Row="1" HorizontalAlignment="Left"></local:PointOnTrackMenuControl>
                            </Grid>

                        </TabItem>
                        <TabItem Header="Скорость">
                            <Grid  Background="#FFE5E5E5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="2.5*"/>
                                    <ColumnDefinition Width="5"/>
                                    <ColumnDefinition Width="3*"/>

                                </Grid.ColumnDefinitions>
                                <DataGrid x:Name="SpeedDataGrid"  
      AutoGenerateColumns="False" 
      Background="#FFF0F0F0" 
      HorizontalGridLinesBrush="Gray"
      SelectionMode="Single"
      SelectionUnit="FullRow" 
      VerticalGridLinesBrush="Gray" ColumnHeaderHeight="60" CanUserResizeRows="False" SelectionChanged="SpeedDataGrid_SelectionChanged" RowEditEnding="SpeedDataGrid_RowEditEnding"  >
                                    <DataGrid.Resources>
                                        <Style TargetType="{x:Type DataGridCell}">
                                            <Style.Triggers>
                                                <Trigger Property="DataGridCell.IsSelected" Value="True" >
                                                    <Setter Property="Background" Value="LightBlue" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>

                                    </DataGrid.Resources>
                                    <DataGrid.Columns>

                                        <DataGridTextColumn Header="станция / перегон" Width="120" Binding="{Binding Path=Station}" />
                                        <DataGridTextColumn Header="путь" Width="35" Binding="{Binding Path=TrackNumber}"/>
                                        <DataGridTextColumn Header="нач Км" Binding="{Binding Path=StartPointOnTrackKm}"/>
                                        <DataGridTextColumn Header="нач Пк" Binding="{Binding Path=StartPointOnTrackPk}"/>
                                        <DataGridTextColumn Header="нач М" Binding="{Binding Path=StartPointOnTrackM}"/>
                                        <DataGridTextColumn Header="кон Км" Binding="{Binding Path=EndPointOnTrackKm}"/>
                                        <DataGridTextColumn Header="кон Пк" Binding="{Binding Path=EndPointOnTrackPk}"/>
                                        <DataGridTextColumn Header="кон М" Binding="{Binding Path=EndPointOnTrackM}"/>
                                        <DataGridTextColumn Header="Км/ч" Binding="{Binding Path=Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <DataGridCheckBoxColumn  Binding="{Binding Path=ForEmptytrainBool}" Width="55" >
                                            <DataGridCheckBoxColumn.Header>
                                                <TextBlock Text="для порожнего поезда" Width="65" TextWrapping="Wrap" />
                                            </DataGridCheckBoxColumn.Header>
                                        </DataGridCheckBoxColumn>

                                        <DataGridCheckBoxColumn Binding="{Binding Path=OnlyHeaderBool}" Width="60" >
                                            <DataGridCheckBoxColumn.Header>
                                                <TextBlock Text="только головой" Width="60" TextWrapping="Wrap" />
                                            </DataGridCheckBoxColumn.Header>
                                        </DataGridCheckBoxColumn>
                                        <DataGridTextColumn Binding="{Binding Path=StartRouteCoordinate}" Visibility="Hidden" >
                                            <DataGridTextColumn.Header>
                                                <TextBlock Text="Координата по маршруту" Width="100" TextWrapping="Wrap" />
                                            </DataGridTextColumn.Header>
                                        </DataGridTextColumn>
                                    </DataGrid.Columns>

                                </DataGrid>

                                <GridSplitter Grid.Column="1"  Grid.Row="0" Grid.ColumnSpan="1" ShowsPreview="False" Width="5"
HorizontalAlignment="Center" VerticalAlignment="Stretch" />


                                <Button Name="AddSpeedButton" Grid.Column="2" Content="Добавить" HorizontalAlignment="Left" Margin="10,10,0,0" VerticalAlignment="Top" Width="84" Click="AddSpeedButton_Click"/>
                                <Button Name="DeleteSpeedButton" Grid.Column="2" Content="Удалить" HorizontalAlignment="Left" Margin="10,35,0,0" VerticalAlignment="Top" Width="84" Click="DeleteSpeedButton_Click"/>
                                <Button x:Name="DeleteAllSpeedButton" Grid.Column="2" Content="Удалить все" HorizontalAlignment="Left" Margin="10,60,0,0" VerticalAlignment="Top" Width="84" Click="DeleteAllSpeedButton_Click"/>
                                <CheckBox Name="RouteCoordinateCheckBox" Grid.Column="2" Content="Координата по маршруту" HorizontalAlignment="Left" Margin="118,12,0,0" VerticalAlignment="Top" Checked="RouteCoordinateCheckBox_Checked" Unchecked="RouteCoordinateCheckBox_Unchecked" IsChecked="False" />
                                <TextBox Grid.Column="2" Name="SegmentIdTextBox" HorizontalAlignment="Left" Margin="187,35,0,0" TextWrapping="Wrap" Text="" VerticalAlignment="Top" Width="51" Height="20" KeyDown="SegmentIdTextBox_KeyDown"/>
                                <TextBlock Grid.Column="2" HorizontalAlignment="Left" Margin="119,35,0,0" TextWrapping="Wrap" Text="Segment Id:" VerticalAlignment="Top" Height="20"/>
                                <Button x:Name="SetSpeedSegmentIdButton" Grid.Column="2" Content="Задать" HorizontalAlignment="Left" Margin="243,35,0,0" VerticalAlignment="Top" Width="47" Click="SetSpeedSegmentIdButton_Click"/>
                                <Button x:Name="FillEmptySpeedsButton" 
                                        Grid.Column="2" 
                                        HorizontalAlignment="Left" 
                                        Margin="10,88,0,0" 
                                        VerticalAlignment="Top" Width="203" 
                                        Click="FillEmptySpeedsButton_Click" Height="22">
                                    <TextBlock Text="Заполнить пустые сегменты" 
                                               TextWrapping="Wrap" 
                                               TextAlignment="Center"/>
                                </Button>
                                <Button x:Name="SaveSpeedButton" Grid.Column="2" Content="Сохранить скорости" HorizontalAlignment="Left" Margin="323,10,0,0" VerticalAlignment="Top" Width="121" Click="SaveSpeedButton_Click"/>


                            </Grid>

                        </TabItem>
                        <TabItem Header="Километры">
                            <Grid Background="#FFE5E5E5">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="2*"/>
                                        <ColumnDefinition Width="5"/>
                                        <ColumnDefinition Width="3*"/>

                                    </Grid.ColumnDefinitions>

                                    <DataGrid x:Name="EgisKmGrid"  
                                              AutoGenerateColumns="False" 
                                              Background="#FFF0F0F0" 
                                              HorizontalGridLinesBrush="Gray" 
                                              VerticalGridLinesBrush="Gray" 
                                              ColumnHeaderHeight="60" 
                                              CanUserResizeRows="False" 
                                              HorizontalAlignment="Left" 
                                              CanUserAddRows="False" 
                                              CanUserDeleteRows="False" Margin="141,20,0,0"  >
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Км" Binding="{Binding Path=Km}" Width="60"/>
                                            <DataGridTextColumn Header="Длина" Binding="{Binding Path=Length}" Width="60"/>
                                        </DataGrid.Columns>
                                    </DataGrid>

                                    <DataGrid x:Name="KmGrid"  
                                              AutoGenerateColumns="False" 
                                              Background="#FFF0F0F0" 
                                              HorizontalGridLinesBrush="Gray" 
                                              VerticalGridLinesBrush="Gray" ColumnHeaderHeight="60" CanUserResizeRows="False" HorizontalAlignment="Left" CanUserAddRows="False" CanUserDeleteRows="False" SelectionChanged="KmGrid_SelectionChanged" Margin="0,20,0,0"  >
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Км" Binding="{Binding Km}" Width="60"/>
                                            <DataGridTextColumn Header="Длина" Binding="{Binding Length}" Width="60"/>
                                        </DataGrid.Columns>
                                    </DataGrid>

                                    <GridSplitter Grid.Column="1"  Grid.Row="0" Grid.ColumnSpan="1" ShowsPreview="False" Width="5"
                                                  HorizontalAlignment="Center" VerticalAlignment="Stretch" />
                                    <TextBlock Background="WhiteSmoke" x:Name="KmTextBlock1" Grid.Column="2" HorizontalAlignment="Left" Margin="10,33,0,0" TextWrapping="Wrap" Text=" " VerticalAlignment="Top" Width="783" Height="63" />
                                    <TextBlock x:Name="KmTextBlock2" Grid.Column="2" HorizontalAlignment="Left" Margin="10,10,0,0" TextWrapping="Wrap" Text="Длина:" VerticalAlignment="Top" Width="43" Height="17" />
                                    <TextBox x:Name="DbKmTextBox" Grid.Column="2" HorizontalAlignment="Left" Margin="58,10,0,0" TextWrapping="Wrap" Text="" VerticalAlignment="Top" Width="60"/>
                                    <Button x:Name="DbKmSetLengthButton" Grid.Column="2" Content="Задать длину" HorizontalAlignment="Left" Margin="123,10,0,0" VerticalAlignment="Top" Height="18" Width="108" Click="DbKmSetLengthButton_Click"/>
                                </Grid>
                            </Grid>
                        </TabItem>
                        <TabItem Header="Платформы">
                            <Grid Background="#FFE5E5E5">
                                <Grid>
                                    <DataGrid x:Name="EgisPlatformsGrid"  
                                    AutoGenerateColumns="False" 
                                    Background="#FFF0F0F0" 
                                    HorizontalGridLinesBrush="Gray" 
                                    VerticalGridLinesBrush="Gray" 
                                    ColumnHeaderHeight="60" 
                                    CanUserResizeRows="False" 
                                    HorizontalAlignment="Left" 
                                        CanUserAddRows="False"  >
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Имя платформы" Binding="{Binding Path=PlatformName}" Width="160"/>
                                            <DataGridTextColumn Header="Нач Км" Binding="{Binding Path=StartPointOnTrackKm}" Width="60"/>
                                            <DataGridTextColumn Header="Нач Пк" Binding="{Binding Path=StartPointOnTrackPk}" Width="60"/>
                                            <DataGridTextColumn Header="Нач М" Binding="{Binding Path=StartPointOnTrackM}" Width="60"/>
                                            <DataGridTextColumn Header="Кон Км" Binding="{Binding Path=EndPointOnTrackKm}" Width="60"/>
                                            <DataGridTextColumn Header="Кон Пк" Binding="{Binding Path=EndPointOnTrackPk}" Width="60"/>
                                            <DataGridTextColumn Header="Кон М" Binding="{Binding Path=EndPointOnTrackM}" Width="60"/>




                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </Grid>
                        </TabItem>
                        <TabItem Header="Светофоры">
                            <Grid Background="#FFE5E5E5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="3*"></ColumnDefinition>
                                    <ColumnDefinition Width="5"/>
                                    <ColumnDefinition Width="4*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>

                                <DataGrid x:Name="EgisToExportTrafficLightsGrid"  
                                            AutoGenerateColumns="False" 
                                            Background="#FFF0F0F0" 
                                            HorizontalGridLinesBrush="Gray" 
                                            VerticalGridLinesBrush="Gray" 
                                            ColumnHeaderHeight="60" 
                                            CanUserResizeRows="False"
                                            CanUserAddRows="False" SelectionChanged="EgisToExportTrafficLightsGrid_SelectionChanged" Margin="0,0,0,0" Grid.ColumnSpan="2"   >
                                    <DataGrid.Columns>
                                        <DataGridTextColumn  Binding="{Binding Path=TrafficLightName}" Width="70">
                                            <DataGridTextColumn.Header>
                                                <TextBlock Text="Имя светофора" TextWrapping="Wrap" />
                                            </DataGridTextColumn.Header>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="тип" Binding="{Binding Path=DicTrafficLightKindName}" Width="100"/>
                                        <DataGridTextColumn Header="Км" Binding="{Binding Path=StartPointOnTrackKm}" Width="40"/>
                                        <DataGridTextColumn Header="Пк" Binding="{Binding Path=StartPointOnTrackPk}" Width="40"/>
                                        <DataGridTextColumn Header="М" Binding="{Binding Path=StartPointOnTrackM}" Width="40"/>
                                        <DataGridTextColumn Header="KindID" Binding="{Binding Path=DicTrafficLightKindID}" Width="60"/>
                                        <DataGridTextColumn Header="EgisABValue" Binding="{Binding Path=EgisABValue}" Width="70"/>
                                        <DataGridTextColumn Binding="{Binding Path=StartRouteCoordinate}">
                                            <DataGridTextColumn.Header>
                                                <TextBlock Text="Route Coordinate" TextWrapping="Wrap" />
                                            </DataGridTextColumn.Header>
                                        </DataGridTextColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <GridSplitter Grid.Column="1"  Grid.Row="0" Grid.ColumnSpan="1" ShowsPreview="False" Width="5" HorizontalAlignment="Center" VerticalAlignment="Stretch" />
                                <Button Name="AddTrafficLightToAddList" 
                                            Grid.Column="2"
                                            Content="Добавить светофор" HorizontalAlignment="Left" 
                                            Margin="10,10,0,0" 
                                            VerticalAlignment="Top" 
                                            Width="117" 
                                            Click="AddTrafficLightToAddList_Click" Height="20"/>
                                <Button Name="InsertTrafficLightsToDb_button" Grid.Column="2" Content="внести в БД" HorizontalAlignment="Left" Margin="137,10,0,0" VerticalAlignment="Top" Width="90" Click="InsertTrafficLightsToDb_button_Click"/>
                                <Grid Name="Trafficlightgrid2" Grid.Column="2" 
                                      Background="White" 
                                      Margin="0,53,0,0">
                                    <local:TrafficLightEditControl  x:Name="trafficLightEditControlMenu" HorizontalAlignment="Left"></local:TrafficLightEditControl>
                                </Grid >

                            </Grid>
                        </TabItem>
                        <TabItem Header="Станции">
                            <Grid Background="#FFE5E5E5">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="3*"/>
                                        <ColumnDefinition Width="1*"/>
                                    </Grid.ColumnDefinitions>
                                    <DataGrid x:Name="EgisToExportStationsGrid"  

                                              AutoGenerateColumns="False" 
                                              Background="#FFF0F0F0" 
                                              HorizontalGridLinesBrush="Gray" 
                                              VerticalGridLinesBrush="Gray" 
                                              ColumnHeaderHeight="60" 
                                              CanUserResizeRows="False" 
                                              HorizontalAlignment="Left" 
                                              CanUserAddRows="False" 
                                              SelectionUnit="FullRow"  >
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Станция" Binding="{Binding Path=StationName}" Width="100"/>

                                            <DataGridTextColumn Binding="{Binding Path=StartPointOnTrackKm}" Width="60" >
                                                <DataGridTextColumn.Header>
                                                    <TextBlock Text="нач КМ" TextWrapping="Wrap" />
                                                </DataGridTextColumn.Header>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="нач Пк" Binding="{Binding Path=StartPointOnTrackPk}" Width="60"/>
                                            <DataGridTextColumn Header="нач М" Binding="{Binding Path=StartPointOnTrackM}" Width="60"/>
                                            <DataGridTextColumn Header="кон Км" Binding="{Binding Path=EndPointOnTrackKm}" Width="60"/>
                                            <DataGridTextColumn Header="кон Пк" Binding="{Binding Path=EndPointOnTrackPk}" Width="60"/>
                                            <DataGridTextColumn Header="кон М" Binding="{Binding Path=EndPointOnTrackM}" Width="60"/>
                                            <DataGridTextColumn Header="координата" Binding="{Binding Path=StartRouteCoordinate}" Width="60"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                    <Button Name="ImportInitialStationNamesToBaseButton" 
                                            Content="Загрузить имена станций в БД" 
                                            HorizontalAlignment="Left" 
                                            Margin="33,10,0,0" 
                                            VerticalAlignment="Top" Width="174" 
                                            Click="ImportInitialStationNamesToBaseButton_Click" Grid.Column="1"/>

                                </Grid>

                            </Grid>
                        </TabItem>
                        <TabItem Header="Уклоны">

                            <Grid >
                                <Grid.ColumnDefinitions >
                                    <ColumnDefinition Width="22*"></ColumnDefinition>
                                    <ColumnDefinition Width="5*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <DataGrid x:Name="EgisToExportInclinesGrid"  
                                    AutoGenerateColumns="False" 
                                    Background="#FFF0F0F0" 
                                    HorizontalGridLinesBrush="Gray" 
                                    VerticalGridLinesBrush="Gray" 
                                    ColumnHeaderHeight="60" 
                                    CanUserResizeRows="False" 
                                    HorizontalAlignment="Left" 
                                    CanUserAddRows="False" Width="1129"  >
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Уклон" Binding="{Binding Path=Value}" Width="100"/>

                                        <DataGridTextColumn Binding="{Binding Path=StartPointOnTrackKm}" Width="45" >
                                            <DataGridTextColumn.Header>
                                                <TextBlock Text="нач КМ" TextWrapping="Wrap" />
                                            </DataGridTextColumn.Header>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="нач Пк" Binding="{Binding Path=StartPointOnTrackPk}" Width="50"/>
                                        <DataGridTextColumn Header="нач М" Binding="{Binding Path=StartPointOnTrackM}" Width="60"/>
                                        <DataGridTextColumn Header="кон Км" Binding="{Binding Path=EndPointOnTrackKm}" Width="45"/>
                                        <DataGridTextColumn Header="кон Пк" Binding="{Binding Path=EndPointOnTrackPk}" Width="60"/>
                                        <DataGridTextColumn Header="кон М" Binding="{Binding Path=EndPointOnTrackM}" Width="60"/>
                                        <DataGridTextColumn Header="координата" Binding="{Binding Path=StartRouteCoordinate}" Width="80"/>
                                        <DataGridTextColumn Header="TrackObjectName" Binding="{Binding Path=TrackObjectName}" Width="280"/>
                                        <DataGridTextColumn Binding="{Binding Path=StartElevation}" Width="55" >
                                            <DataGridTextColumn.Header>
                                                <TextBlock Text="нач высота" TextWrapping="Wrap" />
                                            </DataGridTextColumn.Header>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Binding="{Binding Path=EndElevation}" Width="55" >
                                            <DataGridTextColumn.Header>
                                                <TextBlock Text="кон высота" TextWrapping="Wrap" />
                                            </DataGridTextColumn.Header>
                                        </DataGridTextColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <Button x:Name="ExportInclinesToExcelButton" Grid.Column="1" Content="сохранить в *csv" HorizontalAlignment="Center" Margin="0,10,0,0" VerticalAlignment="Top" Width="110" Height="20" Click="ExportInclinesToExcelButton_Click"/>

                            </Grid>

                        </TabItem>
                        <TabItem Header="ПТ">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                    <ColumnDefinition Width="5"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>

                                </Grid.ColumnDefinitions>
                                <DataGrid x:Name="EgisPtGrid"  

                                          AutoGenerateColumns="False" 
                                          Background="#FFF0F0F0" 
                                          HorizontalGridLinesBrush="Gray" 
                                          VerticalGridLinesBrush="Gray" 
                                          ColumnHeaderHeight="60" 
                                          CanUserResizeRows="False" 
                                          HorizontalAlignment="Left" 
                                          CanUserAddRows="False" 
                                          SelectionUnit="FullRow" SelectionChanged="EgisPtGrid_SelectionChanged"  >
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Вид Проверки" Binding="{Binding Path=TrackObjectName}" Width="100"/>

                                        <DataGridTextColumn Binding="{Binding Path=StartPointOnTrackKm}" Width="60" >
                                            <DataGridTextColumn.Header>
                                                <TextBlock Text="КМ" TextWrapping="Wrap" />
                                            </DataGridTextColumn.Header>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Пк" Binding="{Binding Path=StartPointOnTrackPk}" Width="60"/>
                                        <DataGridTextColumn Header="М" Binding="{Binding Path=StartPointOnTrackM}" Width="60"/>

                                    </DataGrid.Columns>
                                </DataGrid>
                                <DataGrid Name="EgisPtNormsGrid" 
                                          Grid.Column="2"
                                          AutoGenerateColumns="False" 
                                          Background="#FFF0F0F0" 
                                          HorizontalGridLinesBrush="Gray" 
                                          VerticalGridLinesBrush="Gray" 
                                          ColumnHeaderHeight="60" 
                                          CanUserResizeRows="False" 
                                          HorizontalAlignment="Left" 
                                          CanUserAddRows="False" 
                                          SelectionUnit="Cell"  >
                                    <DataGrid.Columns>

                                        <DataGridTextColumn Header="скорость" Binding="{Binding Path=BrakeCheckNormSpeed}" Width="60"/>
                                        <DataGridTextColumn Binding="{Binding Path=BrakeCheckNormPath}" Width="50" >
                                            <DataGridTextColumn.Header>
                                                <TextBlock Text="норма пути" TextWrapping="Wrap" />
                                            </DataGridTextColumn.Header>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Id" Binding="{Binding Path=BrakeCheckPlaceID}" Width="60"/>
                                    </DataGrid.Columns>
                                </DataGrid>

                            </Grid>
                        </TabItem>
                    </TabControl>
                    <TextBlock x:Name="EgisTrackTextBlock" Background="#FFECECEC" Grid.Column="0" HorizontalAlignment="Left" Margin="426,7,0,0" TextWrapping="Wrap" Text=" " VerticalAlignment="Top" Width="74"/>

                </Grid>



            </TabItem>
            <TabItem Header ="ElectronicMap">
                <Grid Name="DbRouteEmapGrid">


                    <Grid.RowDefinitions>
                        <RowDefinition Height="1*"/>
                    </Grid.RowDefinitions>
                    <local:DbRouteEmapControl  x:Name="DbRouteEmapControl_1" />


                </Grid>

            </TabItem>

        </TabControl>


    </Grid>
</Window>
